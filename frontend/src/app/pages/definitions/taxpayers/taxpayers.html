<mat-card class="w-full">
    <div class="flex justify-between items-center p-4 border-b">
        <h2 class="text-xl font-bold m-0 text-slate-800">Mükellefler</h2>
        <button *ngIf="!isEditing()" mat-flat-button color="primary" (click)="startAdd()">
            <mat-icon>add</mat-icon> Yeni Ekle
        </button>
    </div>

    <mat-card-content class="p-6">
        <!-- Form Section -->
        <div *ngIf="isEditing()" class="mb-6 p-6 bg-slate-50 rounded-xl border border-slate-200">
            <h3 class="text-lg font-bold mb-4 text-slate-700">{{ currentTaxpayer().id ? 'Düzenle' : 'Yeni Ekle' }}</h3>
            <div class="flex gap-4 items-start">
                <mat-form-field appearance="outline" class="flex-1">
                    <mat-label>Ad Soyad / Ünvan</mat-label>
                    <input matInput [(ngModel)]="currentTaxpayer().full_name" placeholder="Örn: Ahmet Yılmaz">
                    <mat-icon matPrefix>person</mat-icon>
                </mat-form-field>
                <div class="flex gap-3 mt-1">
                    <button mat-stroked-button (click)="cancelEdit()">İptal</button>
                    <button mat-flat-button color="primary" (click)="save()">Kaydet</button>
                </div>
            </div>
        </div>

        <!-- List Section -->
        <table mat-table [dataSource]="taxpayers()" class="w-full">
            <!-- ID Column -->
            <ng-container matColumnDef="id">
                <th mat-header-cell *matHeaderCellDef class="w-20"> ID </th>
                <td mat-cell *matCellDef="let element" class="text-slate-500 font-mono text-xs"> #{{element.id}} </td>
            </ng-container>

            <!-- Name Column -->
            <ng-container matColumnDef="full_name">
                <th mat-header-cell *matHeaderCellDef> Ad Soyad </th>
                <td mat-cell *matCellDef="let element" class="font-bold text-slate-700"> {{element.full_name}} </td>
            </ng-container>

            <!-- Actions Column -->
            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef class="text-right w-32"> İşlemler </th>
                <td mat-cell *matCellDef="let element" class="text-right">
                    <button mat-icon-button color="primary" (click)="startEdit(element)" matTooltip="Düzenle">
                        <mat-icon>edit</mat-icon>
                    </button>
                    <button mat-icon-button color="warn" (click)="delete(element.id)" matTooltip="Sil">
                        <mat-icon>delete</mat-icon>
                    </button>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['id', 'full_name', 'actions']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['id', 'full_name', 'actions'];" class="hover:bg-slate-50"></tr>
            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell p-8 text-center text-slate-400" colspan="3">
                    <mat-icon class="text-4xl mb-2">inbox</mat-icon>
                    <div>Kayıt bulunamadı.</div>
                </td>
            </tr>
        </table>
    </mat-card-content>
</mat-card>